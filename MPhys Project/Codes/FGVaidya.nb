(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12969,        344]
NotebookOptionsPosition[     12121,        312]
NotebookOutlinePosition[     12460,        327]
CellTagsIndexPosition[     12417,        324]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "We", " ", "wish", " ", "to", " ", "look", " ", "for", " ", "a", " ", 
      "metric", " ", "of", " ", "Fefferman"}], "-", 
     RowBox[{"Graham", " ", "form", " ", 
      FractionBox[
       SuperscriptBox["dr", "2"], 
       SuperscriptBox["r", "2"]]}], "+", 
     RowBox[{
      SuperscriptBox["r", "2"], 
      SubscriptBox["g", "ij"], 
      RowBox[{"(", 
       RowBox[{"x", ",", "r"}], ")"}], 
      SuperscriptBox["dx", "i"], 
      SuperscriptBox["dx", "j"], " ", "where", " ", "i"}]}], ",", 
    RowBox[{
    "j", " ", "run", " ", "over", " ", "all", " ", "coordinates", " ", 
     "apart", " ", "from", " ", "r", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"i", ".", "e", ".", " ", "1"}], ",", "2"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Vaidya", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "-", "m"}], ")"}]}], 
      SuperscriptBox["dt", "2"]}], "+", 
     FractionBox[
      SuperscriptBox["dr", "2"], 
      RowBox[{
       SuperscriptBox["r", "2"], "-", "m"}]], "+", 
     RowBox[{
      SuperscriptBox["r", "2"], 
      SuperscriptBox["dx", "2"]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6383627952195063`*^9, 3.638362893066244*^9}, {
  3.63836296516038*^9, 3.6383629690515823`*^9}, {3.63836381802354*^9, 
  3.638363822681879*^9}, {3.638364370069931*^9, 3.638364498091579*^9}, {
  3.63879464137505*^9, 3.638794644352273*^9}, {3.640185281855217*^9, 
  3.640185282541376*^9}, {3.640186720081397*^9, 3.6401867652765293`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Make", " ", "substitutions", " ", "v"}], "=", 
    RowBox[{
     RowBox[{"t", "+", 
      FractionBox["v1", "\[Rho]"], "+", 
      FractionBox["v2", 
       SuperscriptBox["\[Rho]", "2"]], "+"}], "..."}]}], ",", " ", 
   RowBox[{"r", "=", 
    RowBox[{
     RowBox[{"\[Rho]", "+", "r0", "+", 
      FractionBox["r1", "\[Rho]"], "+", 
      FractionBox["r2", 
       SuperscriptBox["\[Rho]", "2"]], "+"}], "..."}]}], ",", 
   RowBox[{"x", "=", 
    RowBox[{
     RowBox[{"\[Chi]", "+", 
      FractionBox["x1", "\[Rho]"], "+", 
      FractionBox["x2", 
       SuperscriptBox["\[Rho]", "2"]], "+"}], "..."}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.638363185802991*^9, 3.638363284535082*^9}, {
  3.638363327625978*^9, 3.638363350815281*^9}, {3.638363384776347*^9, 
  3.63836341727316*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"\[Rho]", "+", "r0", "+", 
    FractionBox["r1", "\[Rho]"], "+", 
    FractionBox["r2", 
     SuperscriptBox["\[Rho]", "2"]], "+", 
    FractionBox["r3", 
     SuperscriptBox["\[Rho]", "3"]], "+", 
    FractionBox["r4", 
     SuperscriptBox["\[Rho]", "4"]], "+", 
    FractionBox["r5", 
     SuperscriptBox["\[Rho]", "5"]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.638363456372312*^9, 3.6383635032133083`*^9}, {
   3.638363586717854*^9, 3.63836360547327*^9}, {3.638382739093261*^9, 
   3.6383827771830587`*^9}, {3.638527560829938*^9, 3.638527604132862*^9}, {
   3.638794221391485*^9, 3.638794258646051*^9}, 3.63879429411521*^9, {
   3.640186775940681*^9, 3.640186776549366*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dr", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"r", ",", "\[Rho]"}], "]"}], "d\[Rho]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.638363529883893*^9, 3.638363559894869*^9}, {
   3.638363631953629*^9, 3.638363782234833*^9}, 3.640186813975809*^9}],

Cell[BoxData[
 RowBox[{"d\[Rho]", " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"5", " ", "r5"}], 
     SuperscriptBox["\[Rho]", "6"]], "-", 
    FractionBox[
     RowBox[{"4", " ", "r4"}], 
     SuperscriptBox["\[Rho]", "5"]], "-", 
    FractionBox[
     RowBox[{"3", " ", "r3"}], 
     SuperscriptBox["\[Rho]", "4"]], "-", 
    FractionBox[
     RowBox[{"2", " ", "r2"}], 
     SuperscriptBox["\[Rho]", "3"]], "-", 
    FractionBox["r1", 
     SuperscriptBox["\[Rho]", "2"]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.6383635625376797`*^9, {3.63836369448656*^9, 3.638363703161442*^9}, 
   3.638363785322571*^9, 3.638363827324297*^9, 3.638365888123013*^9, 
   3.638366354029595*^9, 3.638366826240858*^9, 3.638367677381208*^9, 
   3.6383691264159517`*^9, 3.638369345666553*^9, 3.638369460951787*^9, 
   3.63837032732787*^9, 3.638370557541986*^9, 3.63837074094168*^9, 
   3.638370803621817*^9, 3.6383819167002277`*^9, 3.638382260762597*^9, 
   3.6383823530247383`*^9, 3.638382595234043*^9, 3.638382794112164*^9, 
   3.638525538554563*^9, 3.6385272355098886`*^9, 3.638527503570805*^9, 
   3.6385276349998302`*^9, 3.638527951382359*^9, 3.6385322444427137`*^9, 
   3.638532282770287*^9, 3.638533419413137*^9, 3.638533586722015*^9, {
   3.638538446003655*^9, 3.638538452326098*^9}, 3.638538953739278*^9, 
   3.638539135552723*^9, 3.6387942079317503`*^9, 3.638794261748391*^9, 
   3.638794297221738*^9, 3.638794329578912*^9, 3.638794410150689*^9, 
   3.638794556026881*^9, 3.638794656327498*^9, 3.638794697524437*^9, 
   3.638795097963564*^9, 3.638795714391385*^9, 3.63879984834197*^9, 
   3.638799952681978*^9, 3.638802237443527*^9, 3.640186832495893*^9, 
   3.640189074741242*^9, 3.6401903341112537`*^9, 3.640190432688404*^9, 
   3.640191451373514*^9, 3.640191698512293*^9, 3.6401920136553707`*^9, 
   3.640193011470557*^9, 3.6401930523305883`*^9, 3.640196976185124*^9, 
   3.640197157098439*^9, 3.640197199281925*^9, 3.64019951974207*^9, 
   3.640200493348722*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vaidya", "=", 
   RowBox[{"Expand", "[", "Vaidya", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.638363791315144*^9, 3.638363791906435*^9}, 
   3.638370260487863*^9, {3.638532250077381*^9, 3.638532253230865*^9}, {
   3.638532287561802*^9, 3.638532296569643*^9}, {3.640186842801689*^9, 
   3.640186846406094*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vaidya", "=", 
   RowBox[{"Vaidya", "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Rho]", "^", "b_"}], "/;", 
      RowBox[{"b", "\[LessEqual]", 
       RowBox[{"-", "5"}]}]}], "\[Rule]", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.638527274545114*^9, 3.638527284949625*^9}, 
   3.6385322561809187`*^9, 3.638533426362974*^9, 3.6385384703644342`*^9, {
   3.638794308266253*^9, 3.638794323172948*^9}, {3.638794402726717*^9, 
   3.638794414505365*^9}, {3.638795104364275*^9, 3.6387951048237886`*^9}, {
   3.638802227288653*^9, 3.638802227419073*^9}, {3.640199527817631*^9, 
   3.6401995282854557`*^9}, {3.640200498816049*^9, 3.6402004992342777`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vaidya", "=", 
   RowBox[{"Vaidya", "/.", 
    RowBox[{"First", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"Vaidya", ",", 
           SuperscriptBox["d\[Rho]", "2"]}], "]"}], "\[Equal]", 
         FractionBox["1", 
          SuperscriptBox["\[Rho]", "2"]]}], ",", "r1"}], "]"}], "]"}], 
     "]"}]}]}], ";", "  ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Enforce", " ", "metric", " ", "to", " ", "be", " ", "of", " ", "FG", " ",
      "form", " ", 
     RowBox[{"in", ".", " ", 
      SuperscriptBox["d\[Rho]", "2"]}], " ", "coefficient"}], "=", 
    FractionBox["1", 
     SuperscriptBox["\[Rho]", "2"]]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.638364772895349*^9, 3.6383648584897003`*^9}, {
   3.6383649962721024`*^9, 3.638364996952504*^9}, {3.638365051545724*^9, 
   3.638365062358583*^9}, {3.6383650946430187`*^9, 3.638365100000988*^9}, {
   3.638365900783822*^9, 3.638365933528863*^9}, {3.638366001233755*^9, 
   3.638366009037969*^9}, {3.638366117434493*^9, 3.638366123384511*^9}, 
   3.638366538197235*^9, {3.638366850845026*^9, 3.638366869681937*^9}, {
   3.638366921800951*^9, 3.638366967238825*^9}, {3.6383670534515038`*^9, 
   3.638367105645636*^9}, {3.6383671376112337`*^9, 3.638367139034075*^9}, {
   3.638367708262866*^9, 3.6383677280424623`*^9}, {3.638369625463542*^9, 
   3.638369630375621*^9}, 3.638370748894765*^9, {3.6383728101866827`*^9, 
   3.638372849649933*^9}, 3.638532416751886*^9, 3.638533434315138*^9, {
   3.640190426199832*^9, 3.6401904271318703`*^9}, 3.640196984961687*^9, 
   3.640197172115848*^9, 3.6401972155600147`*^9, 3.640199513272241*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"Vaidya", ",", 
     SuperscriptBox["d\[Rho]", "2"]}], "]"}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"check", " ", "correct", " ", "coeff"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.638366753596809*^9, 3.6383667546518393`*^9}, {
  3.638367740730846*^9, 3.638367750055682*^9}, {3.6385321950964127`*^9, 
  3.6385322073979197`*^9}}],

Cell[BoxData[
 FractionBox["1", 
  SuperscriptBox["\[Rho]", "2"]]], "Output",
 CellChangeTimes->{
  3.638366755659224*^9, 3.638367382860484*^9, 3.63836773895899*^9, 
   3.638369138384115*^9, 3.6383693725265923`*^9, 3.638370217671442*^9, 
   3.638370341379611*^9, 3.638370375361455*^9, 3.638370590615025*^9, 
   3.6383708260555677`*^9, 3.638381938612008*^9, 3.638382290483033*^9, 
   3.638382372833346*^9, 3.638382639452402*^9, 3.6383830500508327`*^9, 
   3.638525984998073*^9, 3.638527355640411*^9, 3.63852769005724*^9, 
   3.638532191922722*^9, 3.638532441712593*^9, 3.638533445975149*^9, 
   3.638533603084464*^9, {3.638538478375845*^9, 3.638538484886235*^9}, {
   3.638539014050866*^9, 3.638539018757195*^9}, 3.6385391539138823`*^9, 
   3.6387943585287123`*^9, 3.6387944199919157`*^9, 3.638794568670299*^9, 
   3.638794706324004*^9, 3.638795116516816*^9, 3.638795726098913*^9, {
   3.6387998603154373`*^9, 3.638799879495893*^9}, 3.638799970184619*^9, 
   3.640190449656331*^9, 3.640191657577458*^9, 3.640191708632793*^9, 
   3.6401920209629917`*^9, 3.6401930276271763`*^9, 3.640193061103985*^9, 
   3.6401969884416533`*^9, 3.640197219117584*^9, 3.640199533659677*^9, 
   3.640200505822741*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Vaidya", "=", 
   RowBox[{"Vaidya", "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Rho]", "^", "b_"}], "/;", 
      RowBox[{"b", "\[LessEqual]", 
       RowBox[{"-", "4"}]}]}], "\[Rule]", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.638795737846229*^9, 3.63879573837432*^9}, 
   3.640193038716646*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.638794719343204*^9, 3.638795128454907*^9, 3.640191711209237*^9, {
   3.640192030732546*^9, 3.6401920644522038`*^9}, 3.640192124496088*^9, {
   3.640193141162098*^9, 3.6401931463249187`*^9}, {3.640197133292404*^9, 
   3.640197137701275*^9}, {3.640200345816032*^9, 3.640200457892355*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"Vaidya", ",", 
    SuperscriptBox["dx", "2"]}], "]"}], "/.", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]", "^", "b_"}], "/;", 
    RowBox[{"b", "\[LessEqual]", 
     RowBox[{"-", "2"}]}]}], "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.640200467301917*^9, 3.640200472741036*^9}, {
  3.640200552630419*^9, 3.640200690501617*^9}, {3.640200963580278*^9, 
  3.640200979080542*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r0", "2"], "+", 
  FractionBox[
   RowBox[{"2", " ", "r2"}], "\[Rho]"], "+", 
  RowBox[{"2", " ", "r0", " ", "\[Rho]"}], "+", 
  SuperscriptBox["\[Rho]", "2"]}]], "Output",
 CellChangeTimes->{{3.6402006333960323`*^9, 3.64020069170255*^9}, {
  3.640200964438383*^9, 3.640200979657495*^9}}]
}, Open  ]]
},
WindowSize->{650, 716},
WindowMargins->{{-10, Automatic}, {Automatic, -10}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1655, 46, 143, "Input"],
Cell[2216, 68, 857, 24, 81, "Input"],
Cell[3076, 94, 736, 17, 60, "Input"],
Cell[CellGroupData[{
Cell[3837, 115, 313, 8, 55, "Input"],
Cell[4153, 125, 1993, 39, 53, "Output"]
}, Open  ]],
Cell[6161, 167, 349, 7, 32, "Input"],
Cell[6513, 176, 692, 14, 32, "Input"],
Cell[7208, 192, 1732, 36, 195, "Input"],
Cell[CellGroupData[{
Cell[8965, 232, 433, 10, 59, "Input"],
Cell[9401, 244, 1196, 19, 53, "Output"]
}, Open  ]],
Cell[10612, 266, 345, 10, 32, "Input"],
Cell[10960, 278, 337, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[11322, 287, 450, 12, 37, "Input"],
Cell[11775, 301, 330, 8, 51, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
